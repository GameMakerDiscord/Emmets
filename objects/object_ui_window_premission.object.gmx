<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>sprite_window</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>0</depth>
  <persistent>0</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>hostWindow = createWindow(translate("GENERAL_UI", "confirm"), "", array(noone), true);

depth = hostWindow.depth-1;

hostWindow.width = 320;
hostWindow.height = 320;
hostWindow.x = (SCREEN_WIDTH-hostWindow.width)/2;
hostWindow.y = (SCREEN_HEIGHT-hostWindow.height)/2;

x = hostWindow.x+UI_LEFT_BAND;
y = hostWindow.y+UI_TOP_BAND;

interiorPadding = 8;
textInteriorPadding = 5;

xButtonSize = UI_TOP_BAND-2;

hostWindow.controlButtonsSize = xButtonSize+interiorPadding;

width = hostWindow.width - UI_RIGHT_BAND - UI_LEFT_BAND;
height = hostWindow.height - UI_TOP_BAND - UI_LEFT_BAND;

colors = 
        array(COLOR_FOREGROUND(),
                COLOR_BACKGROUND(), 
                COLOR_SHADOW());
hoveredColors = 
        array(COLOR_BACKGROUND(),
                COLOR_FOREGROUND(), 
                COLOR_SHADOW());
                
hoveredX = false;

buttonMargin = 4;
buttonWSpacing = 12;
buttonWidth = 96;
buttonZoneHeight = 32;
buttonHeight = buttonZoneHeight-buttonMargin;

leftText = array(noone);
rightText = array(noone);

cave = noone;

calculated = false;
totalCost = 0;

hoveredBack = false;
hoveredOK = false;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// EXIT IF WINDOWS ONTOP
willExit = anotherWindowOnTop();
if (willExit){
    exit;
}
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
var left = x+interiorPadding;
var right = x+width-interiorPadding-UI_RIGHT_BAND;
var top = y+interiorPadding+UI_TOP_BAND;
var bottom = y+height+interiorPadding-UI_LEFT_BAND-UI_TOP_BAND;

if (!calculated){
    totalCosts = 0;
    
    var rp = ds_list_size(object_station.crew) * object_station.emmetRiskPrime;
    var core = object_station.coringPricePerLevel*object_game.currentLevel + getCaveStatsPrice(cave[? CAVE_BONUS], cave[? CAVE_MALUS]);
    rightText = array(
         rp,
         core
      );        
    totalCost += rp + core;
        
    leftText = array(
        string_replace(translate("PREMISSION", "riskPrime"), "%s", string(ds_list_size(object_station.crew))),
        translate("PREMISSION", "coring")
    );
    
    var requiredBuildings = getRequiredBuildings();
    
    for (var i = 0; i &lt; array_length_1d(requiredBuildings); i++){
        var building = requiredBuildings[i];
        
        var buildingPrice = getBuilding(building, "price");
        var name = getBuilding(building, "name");
        
        leftText[array_length_1d(leftText)] = name+" x1";
        
        if (getHardStock(building) &gt; 0){
            rightText[array_length_1d(rightText)] = 0;
        }
        else{
            rightText[array_length_1d(rightText)] = buildingPrice;
            totalCost += buildingPrice;
        }
    }
    
    rightText[array_length_1d(rightText)] = "=====";
    rightText[array_length_1d(rightText)] = ""; 
    rightText[array_length_1d(rightText)] =  totalCost;
    rightText[array_length_1d(rightText)] = numberFormat(object_station.company[? "funds"])+" - "+numberFormat(totalCost);
    rightText[array_length_1d(rightText)] =  object_station.company[? "funds"]-totalCost;
    
    leftText[array_length_1d(leftText)] = "====="; 
    leftText[array_length_1d(leftText)] = ""; 
    leftText[array_length_1d(leftText)] = translate("PREMISSION", "total");
    leftText[array_length_1d(leftText)] = translate("PREMISSION", "finalFunding");
    leftText[array_length_1d(leftText)] = ""; 
    
    calculated = true;
}

colors = 
        array(COLOR_FOREGROUND(),
                COLOR_BACKGROUND(), 
                COLOR_SHADOW());
hoveredColors = 
        array(COLOR_BACKGROUND(),
                COLOR_FOREGROUND(), 
                COLOR_SHADOW());


/// 0. Close button
var pos = array(x+width-xButtonSize, hostWindow.y, x+width+UI_RIGHT_BAND, hostWindow.y+xButtonSize);
if (mouseIn(pos)){
    hoveredX = true;
    if (global.i[I_SELECT]){
        playSfx(sound_sfx_select);
        closeWindow(hostWindow);
        instance_destroy();
    }
}
else{
    hoveredX = false;
}


var confirmBlock = array(right-buttonWidth, bottom-buttonZoneHeight, right, bottom);
if (mouseIn(confirmBlock)){
    hoveredOK = true;
    if (global.i[I_SELECT]){
        playSfx(sound_sfx_select);
        switch(cave[? CAVE_WORLD]){
            case WORLDTYPE_ICE:
                addToStat("iceWorlds", 1);
                break;
                
            case WORLDTYPE_DIRT:
                addToStat("dirtWorlds", 1);
                break;
                
            case WORLDTYPE_LAVA:
                addToStat("lavaWorlds", 1);
                break;
        }
        launchMission(cave, totalCost);
        instance_destroy();
    }
}
else{
    hoveredOK = false;
}

var backBlock = array(left, bottom-buttonZoneHeight, left+buttonWidth, bottom);
if (mouseIn(backBlock)){
    hoveredBack = true;
    if (global.i[I_SELECT]){
        playSfx(sound_sfx_select);
        closeWindow(hostWindow);
        instance_destroy();
    }
}
else{
    hoveredBack = false;
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>var left = x+interiorPadding;
var right = x+width-interiorPadding-UI_RIGHT_BAND;
var top = y+interiorPadding+UI_TOP_BAND;
var bottom = y+height+interiorPadding-UI_LEFT_BAND-UI_TOP_BAND;


/// 0. Close button
var pos = array(x+width-xButtonSize, hostWindow.y, x+width+UI_RIGHT_BAND, hostWindow.y+xButtonSize);

var colorsUsed = hostWindow.colors;
if (hoveredX){
    colorsUsed = hostWindow.hoveredColors;
}

drawBlock(pos, colorsUsed);

draw_set_valign(fa_middle);
draw_set_halign(fa_center);
drawShadowedText(pos[0]+(pos[2]-pos[0])/2, pos[1]+(pos[3]-pos[1])/2, "X", colorsUsed);

/// 1. Draw background
draw_set_color(COLOR_SHADOW());
draw_rectangle(x, y, x+width-2,  y+height-2, false);

draw_set_color(COLOR_FOREGROUND());
draw_rectangle(x, y, x+width+2,  y+height+2, false);

draw_set_color(COLOR_BACKGROUND());
draw_rectangle(x, y, x+width, y+height, false);

draw_set_font(font_ui);

/// 2. Interior
draw_set_valign(fa_top);

var lh = string_height("A");
var textStart = top+lh*2;

drawShadowedText(floormean(left, right), floor(top-lh/2), translate("PREMISSION", "missionCost")+"#"+translate("GENERAL_UI", "cave")+" "+generateCaveName(cave));

for (var i = 0; i &lt; array_length_1d(leftText); i++){
    draw_set_font(font_ui);
    
    var text = leftText[i];
    var cost = rightText[i];
    var customColors = array(COLOR_FOREGROUND(), COLOR_BACKGROUND(), COLOR_SHADOW());
    
    draw_set_halign(fa_left);
    drawShadowedText(left, textStart+lh*i, text);
    
    if (i == array_length_1d(leftText)-1){
        draw_set_font(font_name);
        var minus = "";
        if (cost &lt; 0){
            customColors[0] = c_red;
        }
        if (cost &lt; 0){
            minus = "-";
            cost *= -1;
        }
        cost = minus + "₵"+numberFormat(cost);
    }
    else if (is_real(cost)){
        if (cost &gt; 0){
            cost = "- ₵"+numberFormat(cost);
        }
        else{
            customColors[0] = COLOR_SHADOW();
            cost = translate("PREMISSION", "inStock");
        }
    }
    
    draw_set_halign(fa_right);
    drawShadowedText(right, textStart+lh*i, cost, customColors);
}

/// 3. Buttons
draw_set_valign(fa_middle);
draw_set_halign(fa_center);
var myColors = colors;
if (hoveredBack){
    myColors = hoveredColors;
}
var backBlock = array(left, bottom-buttonZoneHeight, left+buttonWidth, bottom);
drawBlock(backBlock, myColors);
drawShadowedText(floormean(backBlock[0], backBlock[2]), floormean(backBlock[1], backBlock[3]), translate("GENERAL_UI", "cancel"));

var myColors = colors;
if (hoveredOK){
    myColors = hoveredColors;
}
var confirmBlock = array(right-buttonWidth, bottom-buttonZoneHeight, right, bottom);
drawBlock(confirmBlock, myColors);
drawShadowedText(floormean(confirmBlock[0], confirmBlock[2]), floormean(confirmBlock[1], confirmBlock[3]), translate("PREMISSION", "letsgo"));

</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
